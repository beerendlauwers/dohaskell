--------------------------------------------------------------------------------
-- User

User
    name            Text
    displayName     Text
    isAdministrator Bool
    UniqueUserName name
    deriving Typeable

Favorite
    userId UserId
    resId  ResourceId
    UniqueFavorite userId resId

Grokked
    userId UserId
    resId  ResourceId
    UniqueGrokked userId resId

--------------------------------------------------------------------------------
-- Resource

Resource
    title  Text
    author Text Maybe
    url    Text
    type   ResourceType
    userId UserId
    posted UTCTime
    UniqueResourceUrl url
    deriving Eq Ord

Tag
    text Text
    UniqueTagText text

ResourceTag
    resId ResourceId
    tagId TagId
    UniqueResourceTag resId tagId

-- Currently unused
Difficulty
    resId  ResourceId
    userId UserId
    val    Int
    UniqueDifficulty resId userId

--------------------------------------------------------------------------------
-- Pending resource edits

-- Caveat: can't have a uniqueness constraint on a NULLABLE field. This means
-- there may be two pending edits for the same author name change. Oh well.
EditAuthor
    resId ResourceId
    author Text Maybe

EditTitle
    resId ResourceId
    title Text
    UniqueEditTitle resId title

EditType
    resId ResourceId
    type  ResourceType
    UniqueEditType resId type

EditAddTag
    resId ResourceId
    text  Text
    UniqueEditAddTag resId text

EditRemoveTag
    resId ResourceId
    text  Text
    UniqueEditRemoveTag resId text
